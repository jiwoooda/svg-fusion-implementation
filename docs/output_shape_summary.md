# 출력 형태 요약 (캡션 포함 실측 예시)

아래 값들은 **캡션 포함 캐시**에서 뽑은 실제 예시입니다.

## 1) Cache Input 예시
- `filename`: `1f1ff-1f1fc`
- `caption`: `regional indicator symbol letter z regional indicator symbol letter w`
- `svg_tensor row1`: `[4, 1, 5, 5, 0, 0, 0, 0, 0, 221, 31, 14, 254]`
- `pixel_cls first 8`: `[-1.1896296739578247, -0.642375111579895, 3.289231777191162, 3.7767205238342285, 0.7042830586433411, -1.00859797000885, 2.022815465927124, 0.6900511980056763]`

## 2) VAE Output 예시
- `pred row0`: `[0.03392627462744713, -0.6150663495063782, -0.9790225625038147, -0.983264684677124, -0.9981717467308044, -0.9990293383598328, -0.9995940923690796, -0.9996344447135925, -0.9996976256370544, -0.9996610879898071, -0.2741953432559967, -0.33570533990859985, -0.290033221244812, 0.36322134733200073]`
- `pred row1`: `[0.0397607646882534, -0.6069627404212952, -0.9788148999214172, -0.9831516742706299, -0.9982197284698486, -0.9990311861038208, -0.9996073842048645, -0.9996299148162842, -0.9996969103813171, -0.9996588826179504, -0.27042481303215027, -0.32899010181427, -0.2841014862060547, 0.37304672598838806]`

## 2-1) VAE Encoder Output 예시 (mu/log_var)
- `mu shape`: `[B, L, latent_dim]`  (예: `[1, 3, 128]`)
- `log_var shape`: `[B, L, latent_dim]`  (예: `[1, 3, 128]`)
- `mu/log_var`의 실제 수치(평균/표준편차)는 `inspect_report.txt`에서 확인합니다.

## 3) DiT Output 예시
- `pred_noise[0,0,:12]`: `[1.3920061588287354, -0.26676252484321594, 0.22344037890434265, 1.574924111366272, 0.5126659274101257, 0.3214090168476105, 0.4712839126586914, -1.043449878692627, 0.7129831910133362, -1.6150431632995605, -0.14306549727916718, -0.0007861405611038208]`

## 각 예시값 의미 (상세)

### Cache Input (SVG 토큰 + 픽셀 임베딩)
- `filename`의 의미:
  - SVG 파일 이름(코드포인트 기반)입니다. 예: `1f1ff-1f1fc`
- `caption`의 의미:
  - 파일명 코드포인트를 **유니코드 이름**으로 변환해 만든 캡션입니다.
  - 예시: `regional indicator symbol letter z ... letter w`
- `svg_tensor row1`의 의미:
  - 길이 14 벡터는 `[element_id, command_id, param_0..param_11]`입니다.
  - 예시: `[4, 1, 5, 5, 0, 0, 0, 0, 0, 221, 31, 14, 254]`
    - `4` → element_id (요소 타입 ID, 예: path)
    - `1` → command_id (커맨드 ID, 예: 'm')
    - `5,5,0,0,0,0,0,0` → 좌표/기하 파라미터의 **양자화 bin**
    - `221,31,14,254` → 스타일/색상 파라미터의 **양자화 bin**
  - 여기의 값은 **실좌표가 아니라 bin ID**이며, 디코딩 시 역변환됩니다.
- `pixel_cls first 8`의 의미:
  - DINOv2 CLS 임베딩의 앞 8개 차원 값입니다.
  - 값 범위는 정규화된 임베딩이라 제한이 없습니다.

### VAE Output (디코더 연속 출력)
- `pred row0`, `pred row1`의 의미:
  - VAE 디코더가 **연속값**으로 예측한 `[element_id, command_id, param_0..param_11]`입니다.
  - 값 범위는 `tanh`로 **[-1, 1] 근처**이며,
    이후 `denormalize_output()`으로 정수 토큰(bin/ID)으로 변환됩니다.
  - 예: `-0.999...`는 낮은 bin/ID 쪽에 가까움을 의미합니다.

### VAE Encoder Output (mu/log_var)
- `mu`는 잠재 분포의 평균, `log_var`는 잠재 분산의 로그입니다.
- `z = mu + eps * exp(0.5 * log_var)` 형태로 샘플링되어 디코더에 입력됩니다.
- `mu/log_var`의 평균/표준편차는 `inspect_outputs.sh` 실행 결과(`inspect_report.txt`)에 기록됩니다.

### DiT Output (노이즈 예측)
- `pred_noise[0,0,:12]`의 의미:
  - DiT가 예측한 **노이즈(ε)**의 일부 값입니다.
  - 이 값은 분포가 자유롭고 범위 제한이 없습니다.
  - DiT 학습은 이 노이즈 예측이 실제 주입 노이즈와 일치하도록 MSE로 학습됩니다.

## 참고
- `caption`은 캐시 생성 시에만 저장됩니다. 예전 캐시는 `None`일 수 있습니다.
- 캡션 포함 캐시로 갱신하려면 `preprocess`를 최신 코드로 다시 실행하세요.

## 생성 파일 위치
- `/mnt/8TB_1/jiwoo/outputs/dit_sample_*.svg`
- `/mnt/8TB_1/jiwoo/outputs/dit_sample_*.svg.png`
- `/mnt/8TB_1/jiwoo/outputs/recon/*`
- `/mnt/8TB_1/jiwoo/outputs/samples/*`
